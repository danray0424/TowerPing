////  MainViewController.m//  TowerPing////  Created by Daniel Ray on 7/9/10.//  Copyright Dynamic  Quest 2010. All rights reserved.//#import "MainViewController.h"#import <CoreLocation/CoreLocation.h>@implementation MainViewController@synthesize table;@synthesize hitCount;@synthesize events;@synthesize manager;-(IBAction)start{	[self.manager startMonitoringSignificantLocationChanges];	self.hitCount.text = [NSString stringWithFormat:@"Running - %d hits", [self.events count]];}-(IBAction)stop{	[self.manager stopMonitoringSignificantLocationChanges];	self.hitCount.text = [NSString stringWithFormat:@"Stopped - %d hits", [self.events count]];}-(void) locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation{	[self.events addObject:newLocation];	[self.table reloadData];	self.hitCount.text = [NSString stringWithFormat:@"Running - %d hits", [self.events count]];}-(NSInteger) numberOfSectionsInTableView:(UITableView *)tableView{	return 1;}-(NSInteger) tableView:(UITableView *)table numberOfRowsInSection:(NSInteger)section{	return [self.events count];}-(UITableViewCell *) tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{	static NSString *ident = @"CellIdentifier";	UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:ident];	if (!cell) {		cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:ident];	}	CLLocation *loc = [self.events objectAtIndex:indexPath.row];	cell.textLabel.text = [NSString stringWithFormat:@"%@", loc.timestamp.description];	cell.detailTextLabel.text = [NSString stringWithFormat:@"lat %f, lng %f", loc.coordinate.latitude, loc.coordinate.longitude];	return cell;}// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.- (void)viewDidLoad {	self.events = [[NSMutableArray alloc] init];	self.hitCount.text = @"Not yet started";	self.manager = [[CLLocationManager alloc] init];	manager.delegate = self;		[super viewDidLoad];}- (void)flipsideViewControllerDidFinish:(FlipsideViewController *)controller {    	[self dismissModalViewControllerAnimated:YES];}- (IBAction)showInfo:(id)sender {    		FlipsideViewController *controller = [[FlipsideViewController alloc] initWithNibName:@"FlipsideView" bundle:nil];	controller.delegate = self;		controller.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;	[self presentModalViewController:controller animated:YES];		[controller release];}- (void)didReceiveMemoryWarning {	// Releases the view if it doesn't have a superview.    [super didReceiveMemoryWarning];		// Release any cached data, images, etc. that aren't in use.}- (void)viewDidUnload {	// Release any retained subviews of the main view.	// e.g. self.myOutlet = nil;}/*// Override to allow orientations other than the default portrait orientation.- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {	// Return YES for supported orientations.	return (interfaceOrientation == UIInterfaceOrientationPortrait);}*/- (void)dealloc {	[table release];	[hitCount release];	[events release];	[manager release];    [super dealloc];}@end